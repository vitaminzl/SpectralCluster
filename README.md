# è°±åœ¨èšç±»ä¸­çš„åº”ç”¨

æœ¬æ–‡ä¸»è¦å¯¹è°±èšç±»çš„å‡ ç¯‡è®ºæ–‡è¿›è¡Œè§£è¯»ï¼Œå¹¶å¯¹ä¸€éƒ¨åˆ†çš„ç»“æœè¿›è¡Œå¤ç°ã€‚æœ¬æ–‡é¦–å…ˆä»è°±èšç±»çš„ä¸€èˆ¬è¿‡ç¨‹å…¥æ‰‹ï¼Œä»‹ç»ä¼ ç»Ÿçš„è°±èšç±»æ–¹æ³•NCutsã€NJWã€‚é’ˆå¯¹ä¼ ç»Ÿæ–¹æ³•çš„ç›¸ä¼¼åº¦é‡çš„ç¼ºé™·ï¼Œå¼•å…¥æ”¹è¿›æ–¹æ³•ZPï¼›åˆé’ˆå¯¹ç‰¹å¾å‘é‡çš„é€‰æ‹©é—®é¢˜ï¼Œå¼•å…¥æ”¹è¿›æ–¹æ³•PIã€‚ç»“åˆä»¥ä¸Š2ç§æ–¹å¼ï¼ŒåŠ å…¥TKNNï¼Œå¼•å…¥æ”¹è¿›æ–¹æ³•ROSCï¼Œæ¥ç€å¯¹ROSCä¸­ä¿®æ­£ç›¸ä¼¼åº¦çŸ©é˜µçš„ç¼ºé™·ï¼Œç»“åˆtrace lassoæ­£åˆ™é¡¹ï¼Œå¼•å…¥æ”¹è¿›æ–¹æ³•CASTã€‚æœ€åï¼Œå¯¹äºROSCå’ŒCASTä¸­éƒ½æåˆ°çš„Group Effectè¿›è¡Œè§£è¯»ã€‚æ–‡ç« ç»“å°¾è¡¥å……äº†å¹‚ä»£æ³•å’ŒçŸ©é˜µæ±‚å¯¼çš„å†…å®¹ã€‚å…¶ä¸­æˆ‘åˆ†åˆ«å¯¹PIæ–¹æ³•å’ŒROSCæ–¹æ³•è¿›è¡Œä»£ç å¤ç°ã€‚ä»£ç çš„ä»“åº“åœ°å€ï¼š[https://github.com/vitaminzl/SpectralCluster](https://github.com/vitaminzl/SpectralCluster) (å¤‡ç”¨é•œåƒï¼š[https://gitee.com/murphy_z/spectral-cluster](https://gitee.com/murphy_z/spectral-cluster))ã€‚



## Pipeline

![](https://imagehost.vitaminz-image.top/gnn-note-10.png)

è°±èšç±»çš„ä¸€èˆ¬è¿‡ç¨‹å¦‚ä¸Šå›¾æ‰€ç¤º[^2]ã€‚å¯¹äºä¸€ç³»åˆ—çš„æ•°æ®ï¼Œæˆ‘ä»¬é¦–å…ˆè®¡ç®—æ•°æ®ä¹‹é—´çš„ç›¸ä¼¼åº¦çŸ©é˜µ$S$ï¼Œå¸¸ç”¨çš„ç›¸ä¼¼åº¦åº¦é‡ä¸ºé«˜æ–¯æ ¸$S_{ij}=\exp(-\frac{||\vec x_i-\vec x_j||^2}{2\sigma^2})$ï¼Œç„¶åæ±‚å…¶æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ$L=D-S$ï¼Œå…¶ä¸­$D$ä¸ºå¯¹è§’çŸ©é˜µï¼Œä¸”$D_{ii}=\sum A_{ij}$ã€‚ç„¶åæ±‚å‡ºæ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å‘é‡ï¼Œé€‰æ‹©ç‰¹å¾å€¼$k$å°çš„ç‰¹å¾å‘é‡è¿›è¡Œk-meansèšç±»ã€‚

ä»¥ä¸Šè¿‡ç¨‹å¯ä»¥ç†è§£ä¸ºï¼Œå°†åŸæ•°æ®åˆ©ç”¨ç›¸ä¼¼åº¦åº¦é‡è½¬åŒ–ä¸ºå›¾æ•°æ®ï¼Œå³ä½¿å¾—æ¯ä¸ªæ•°æ®é—´è¿ç€ä¸€æ¡â€è™šè¾¹â€œï¼Œç›¸ä¼¼åº¦å³ä¸ºè¾¹çš„æƒé‡ã€‚æ¥ä¸‹æ¥å°†æ•°æ®è½¬æ¢åˆ°é¢‘åŸŸä¸Šï¼Œé€‰æ‹©ä¸€äº›ä½é¢‘ä½œä¸ºæ•°æ®çš„ç‰¹å¾å‘é‡ï¼Œè¿™æ˜¯å› ä¸ºä½é¢‘æˆåˆ†å¾€å¾€å…·æœ‰æ›´é«˜å±‚æ¬¡ã€æ›´å…·ä¿¡æ¯é‡çš„ç‰¹å¾ï¼Œè€Œé«˜é¢‘æˆåˆ†åˆ™æ›´å¯èƒ½æ˜¯å™ªå£°ã€‚ç„¶åå¯¹è¿™äº›ç‰¹å¾å‘é‡è¿›è¡Œèšç±»ã€‚

è€Œè¿™ç§ä¸€èˆ¬çš„æ–¹æ³•åœ¨å¤šå°ºåº¦çš„æ•°æ®èšç±»ä¸­å¾€å¾€è¡¨ç°ä¸ä½³ã€‚



## NCuts

<img src="https://imagehost.vitaminz-image.top/li-spectral-cluster-4.png" style="zoom: 33%;" />

æˆ‘ä»¬é¦–å…ˆä»‹ç»ä¸€äº›è¿œå¤çš„è°±èšç±»æ–¹æ³•ã€‚Normalized Cut[^8]çš„æƒ³æ³•æ¥æºäºæœ€å°å‰²ã€‚å¦‚æœå­˜åœ¨è¿é€šå›¾$\mathcal G=\{\mathcal V, \mathcal E\}$ï¼Œæ¯æ¡è¾¹$e_i\in \mathcal E$æœ‰ç€æƒé‡$w_i$ï¼Œä¸ºäº†ä½¿å¾—è¿é€šå›¾åˆ†å‰²æˆ2ä¸ªè¿é€šå­å›¾ï¼Œé‚£ä¹ˆéœ€è¦ç§»æ‰ä¸€äº›è¾¹ã€‚è‹¥ç§»æ‰è¿™äº›è¾¹æƒä¹‹å’Œæœ€å°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°è¿™æ ·çš„åˆ†å‰²æ–¹æ³•ä¸ºæœ€å°å‰²ã€‚è¿™å’Œèšç±»éå¸¸ç›¸ä¼¼ï¼Œè¾¹æƒå¯ä»¥è¡¨ç¤ºç‚¹å’Œç‚¹çš„è”ç³»ï¼Œè‹¥å­˜åœ¨ä¸¤ä¸ªç±»ï¼Œé‚£ä¹ˆç±»ä¹‹é—´çš„è”ç³»åº”å½“æ˜¯æ¯”è¾ƒå°çš„ï¼Œç±»å†…çš„è”ç³»æ¯”è¾ƒå¤§ã€‚

æ‰€ä»¥ä¸€ç§å¯è¡Œçš„æƒ³æ³•æ˜¯ï¼Œé¦–å…ˆå¯¹è¿é€šå›¾è¿›è¡Œä¸€æ¬¡å–æœ€å°å‰²ï¼Œç„¶åå†å¯¹è¿é€šå­å›¾è¿›ä¸€æ­¥åœ°å–æœ€å°å‰²ï¼Œç›´åˆ°åˆ°è¾¾æŸä¸€é˜ˆå€¼ä¸ºæ­¢ã€‚ä½†æ˜¾ç„¶è¿™æ ·å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè¦ä½¿å»æ‰è¾¹æƒä¹‹å’Œæœ€å°ï¼Œé‚£æ¯æ¬¡åˆ†å‰²è‚¯å¯èƒ½éƒ½ä¼šå€¾å‘äºæŒ‡å‰²æ‰ä¸€æ¡è¾¹ï¼Œè¿™è‡ªç„¶ä¸åˆç†ã€‚

ä¸€ç§è‡ªç„¶çš„æƒ³æ³•ä½¿å¯¹æƒé‡è¿›è¡Œå½’ä¸€åŒ–å¤„ç†
$$
NCut(A,B)=\frac{cut(A,B)}{assoc(A,V)}+\frac{cut(A,B)}{assoc(B,V)}
$$
å…¶ä¸­$assoc(A,V)$è¡¨ç¤º$A$åˆ°æ‰€æœ‰è¿æ¥çš„ç»“ç‚¹æƒé‡ä¹‹å’Œï¼Œ$cut(A,B)$åˆ™æ˜¯åˆ†å‰²åç§»æ‰è¾¹æƒä¹‹å’Œã€‚æ‰€ä»¥å‡å¦‚å½“æŸä¸€ä¾§çš„ç»“ç‚¹éå¸¸å°‘æ—¶ï¼Œé‚£ä¹ˆè¿™$cut$çš„å€¼å¯èƒ½æ¯”$assoc$å¤§ï¼Œæç«¯æƒ…å†µä¸‹å€¼åˆ†å‰²ä¸€ä¸ªç‚¹ï¼Œé‚£ä¹ˆåˆ†æ¯å°±æ˜¯0äº†ï¼Œåˆ™æœ€åçš„ç»“æœæ˜¯æ— ç©·å¤§ã€‚

å› æ­¤åˆ©ç”¨å‰é¢çš„æƒ³æ³•ï¼Œæ¯æ¬¡ä½¿ç”¨$NCut$ï¼Œç„¶åå†å¯¹å­å›¾è¿›è¡Œ$NCut$ï¼Œä¸æ–­è¿›è¡ŒäºŒåˆ†å°±å¯ä»¥äº†ã€‚

å¬èµ·æ¥å¾ˆç®€å•ï¼Œä½†å¾ˆé—æ†¾çš„æ˜¯ï¼Œæ±‚æœ€å°å‰²æ˜¯ä¸€ä¸ªNPéš¾çš„é—®é¢˜ï¼Œå› æ­¤åªèƒ½æ±‚å…¶è¿‘ä¼¼è§£ã€‚

é€šè¿‡ä¸€ç³»åˆ—çš„å¤æ‚æ¨å¯¼ï¼ˆå¤ªéš¾äº†å“ˆå“ˆï¼‰ï¼Œå¯ä»¥å¾—åˆ°$D^{-\frac{1}{2}}LD^{-\frac{1}{2}}$ç¬¬2å°çš„ç‰¹å¾å‘é‡å°±æ˜¯å¯¹åº”çš„æœ€å°å‰²ã€‚å½“ç„¶è¿™é‡Œéœ€è¦è®¾å®šä¸€ä¸ªé˜ˆå€¼ï¼Œå› ä¸ºç‰¹å¾å‘é‡æ±‚å‡ºæ¥æ˜¯æµ®ç‚¹æ•°ï¼Œä½†å…¶æ•°æ®ä¼šåå‘ä¸¤çº§ã€‚ç„¶ååˆ©ç”¨ä¸Šé¢çš„äºŒåˆ†æ³•æ±‚è§£å³å¯ã€‚

ä½†æ˜¯ç°åœ¨å¤šæ•°ä½¿ç”¨çš„NCutsæ˜¯$\min NCut(A,B)$é—®é¢˜è½¬åŒ–ä¸ºä»¥ä¸‹ä¼˜åŒ–é—®é¢˜ã€‚
$$
\min \vec x^T(D^{-\frac{1}{2}}LD^{-\frac{1}{2}})\vec x\\
st. \vec x^T\vec x=1
$$
ä¸Šé¢è¿™ä¸ªå½¢å¼å…¶å®å°±æ˜¯ç‘ä¸½ç†µï¼Œé‚£ä¹ˆåªè¦å–$k$ä¸ªæœ€å°çš„ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡è¿›è¡Œèšç±»å³å¯ã€‚



## NJW

NJWç®—æ³•[^6]æ˜¯å–3ä¸ªäººåçš„é¦–å­—æ¯å‘½åçš„ã€‚è¯¥ç®—æ³•å’ŒNCutséå¸¸ç±»ä¼¼ï¼Œç”šè‡³å¯ä»¥çœ‹ä½œæ˜¯å…¶å˜å½¢ã€‚
$$
\begin{align*}
D^{-\frac{1}{2}}LD^{-\frac{1}{2}}&=D^{-\frac{1}{2}}(D-S)D^{-\frac{1}{2}}\\
&=I-D^{-\frac{1}{2}}SD^{\frac{1}{2}}
\end{align*}
$$
æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è½¬è€Œå»æ±‚$D^{-\frac{1}{2}}SD^{\frac{1}{2}}$æœ€å¤§çš„$k$ä¸ªç‰¹å¾å‘é‡ï¼Œç„¶åè¿›è¡Œèšç±»ã€‚



## ZP

å‰é¢æåˆ°è®¡ç®—ç›¸ä¼¼åº¦çŸ©é˜µæ—¶ï¼Œæˆ‘ä»¬å¸¸ç”¨é«˜æ–¯æ ¸$S_{ij}=\exp(-\frac{||\vec x_i-\vec x_j||^2}{2\sigma^2})$ï¼Œè€Œé«˜æ–¯æ ¸ä¸­$\sigma$çš„é€‰å–æ˜¯éœ€è¦è€ƒè™‘çš„ï¼Œå¾ˆå¤šæ—¶å€™å¸¸å¸¸äººå·¥è®¾å®š[^3]ã€‚ä½†æ›´é‡è¦çš„æ˜¯$\sigma$æ˜¯ä¸€ä¸ªå…¨å±€çš„å‚æ•°ï¼Œè¿™åœ¨å¤šå°ºåº¦æ•°æ®ä¸­å…·æœ‰ä¸€äº›ç¼ºé™·ã€‚å¦‚è®¾å®šçš„å€¼è¾ƒå¤§æ—¶ï¼Œç¨ å¯†å›¾çš„æ•°æ®ä¼šè¶‹äºç›¸ä¼¼ï¼Œè®¾å®šè¾ƒå°æ—¶ï¼Œç¨€ç–å›¾çš„æ•°æ®åˆ™ç›¸ä¼¼åº¦è¿‡å°ã€‚

![](https://imagehost.vitaminz-image.top/li-spectral-cluster-8.png)

ZPæ–¹æ³•æå‡ºé‡Œä¸€ç§å±€éƒ¨è°ƒæ•´$\sigma$çš„è®¾å®šï¼Œè·ç¦»åº¦é‡ä¿®æ­£ä¸º$S_{ij}=\exp(-\frac{||\vec x_i-\vec x_j||^2}{2\sigma_i\sigma_j})$ã€‚å…¶ä¸­$\sigma_i, \sigma_j$æ˜¯ä¾é™„äº$\vec x_i, \vec x_j$çš„æ˜¯ä¸€ç§å±€éƒ¨çš„å‚æ•°ã€‚è¿™ä¸€å‚æ•°çš„è®¾å®šåº”é€šè¿‡æ ·æœ¬çš„ç‰¹å¾å–é€‰å–ã€‚åœ¨è®ºæ–‡ä¸­[^3]ä¸­é€‰æ‹©çš„æ–¹æ³•æ˜¯$\vec x_i$åˆ°ç¬¬$K$ä¸ªé‚»å±…çš„æ¬§å¼è·ç¦»ï¼Œå®éªŒè¡¨æ˜$K$å–7åœ¨å¤šä¸ªæ•°æ®é›†ä¸Šçš„æ•ˆæœè¡¨ç°è‰¯å¥½ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç»“ç‚¹ä¹‹é—´çš„è¾¹åšåº¦è¡¨ç¤ºæ•°æ®é—´çš„æƒé‡å¤§å°ï¼ˆä»…æ˜¾ç¤ºå‘¨å›´æ•°æ®çš„æƒé‡ï¼‰ã€‚å›¾bæ˜¯åŸæ¥çš„é«˜æ–¯æ ¸è·ç¦»åº¦é‡ï¼Œå›¾cæ˜¯ä¿®æ­£åçš„ã€‚å¯ä»¥çœ‹åˆ°å›¾bä¸­é è¿‘è“ç‚¹çš„è¾¹ä»ç„¶æ¯”è¾ƒåšï¼Œè€Œå›¾cåˆ™é¿å…äº†çš„è¿™ç§ç°è±¡ã€‚



## PI

PI(Power Iteration)ä¸ºå¹‚è¿­ä»£æ³•[^5]ã€‚å…¶çµæ„Ÿæ¥æºäºå¹‚è¿­ä»£æ³•ç”¨æ±‚ä¸»ç‰¹å¾å€¼ï¼ˆåœ¨[æ–‡ç« çš„åé¢éƒ¨åˆ†](#Dominant Eigenvalue)ä¼šæ›´è¯¦ç»†åœ°è¯´æ˜ï¼‰ã€‚

æˆ‘ä»¬è®¾$W=D^{-1}A$ï¼Œè¯¥çŸ©é˜µæœ‰æ—¶å€™å«è½¬ç§»çŸ©é˜µï¼Œå› ä¸ºå®ƒå’Œé©¬å°”å¯å¤«çš„çŠ¶æ€è½¬ç§»çŸ©é˜µéå¸¸ç±»ä¼¼ã€‚æ¯è¡Œçš„å’Œä¸º1ï¼Œæ¯ä¸ªå…ƒç´ $W_{i,j}$å¯ä»¥çœ‹ä½œæ˜¯$i$ç»“ç‚¹åˆ°$j$ç»“ç‚¹è½¬ç§»çš„æ¦‚ç‡ã€‚å®ƒå’Œå½’ä¸€åŒ–éšæœºæ¸¸èµ°çŸ©é˜µ$L_r=I-W$æœ‰ç€é‡è¦çš„è”ç³»ã€‚NCutsç®—æ³•è¯æ˜äº†$L_r$ç¬¬2å°çš„ç‰¹å¾å€¼æ‰€å¯¹åº”çš„ç‰¹å¾å‘é‡å¯ä»¥ä½œä¸ºNCutsç®—æ³•çš„ä¸€ç§è¿‘ä¼¼ã€‚

è¿™é‡Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œ$L_r$æœ€å°çš„ç‰¹å¾å€¼ä¸º0ï¼Œå®¹æ˜“è¯æ˜$\vec 1=[1, 1, ..., 1]$æ˜¯$L_r$çš„0æ‰€å¯¹åº”çš„ç‰¹å¾å‘é‡ã€‚è€Œå¯¹äº$W$æ¥è¯´åˆ™ï¼Œå…¶æœ€å¤§çš„ç‰¹å¾å€¼ä¸º1ï¼Œä¸”$\vec 1$æ˜¯å¯¹åº”çš„ç‰¹å¾å‘é‡ã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œ$L_r$æœ€å°çš„å‡ ä¸ªç‰¹å¾å‘é‡æˆ–$W$æœ€å¤§çš„å‡ ä¸ªç‰¹å¾å‘é‡æ˜¯æœ‰æ•ˆçš„ï¼Œå…¶ä½™å¯èƒ½æ˜¯å™ªå£°ã€‚

é¦–å…ˆç»™å®šä¸€ä¸ªå‘é‡$\vec v^{(0)}= c_1\vec  e_1 + c_2\vec e_2,..., +c_n\vec e_n$ï¼Œå…¶ä¸­$\vec e_i$ä¸º$W$çš„ç‰¹å¾å‘é‡ã€‚ä¸”$\vec e_i$æ‰€å¯¹åº”çš„ç‰¹å¾å€¼$\lambda_i$æ»¡è¶³$1=\lambda_1 > \lambda_2>...>\lambda_n$ã€‚

$$
\vec v^{(t+1)} = \frac{W\vec v^{(t)}}{||W\vec v^{(t)}||_1}
$$
å‡å¦‚æˆ‘ä»¬æŒ‰ç…§å¦‚ä¸Šçš„è¿­ä»£å…¬å¼è¿›è¡Œè¿­ä»£ï¼Œåˆ™æœ‰å¦‚ä¸‹è¿‡ç¨‹ï¼ˆæš‚ä¸”å¿½ç•¥è¿­ä»£å…¬å¼çš„åˆ†æ¯å½’ä¸€åŒ–é¡¹ï¼‰
$$
\begin{align*}
\vec v^{(1)} &= W \vec v^{(0)} 
\\&=c_1W\vec  e_1 + c_2W\vec e_2,..., +c_nW\vec e_n
\\&=c_1\lambda_1  e_1 + c_2\lambda_2\vec e_2,..., +c_n\lambda_n\vec e_n
\end{align*}
$$
åˆ™
$$
\begin{align*}
\vec v^{(t)} &= Wv^{(tâˆ’1)} = W^2v^{(tâˆ’2)} = ... = W^tv^{(0)}
\\&=c_1W^t\vec  e_1 + c_2W^t\vec e_2,..., +c_nW^t\vec e_n
\\&=c_1\lambda_1^t  e_1 + c_2\lambda_2^t\vec e_2,..., +c_n\lambda_n^t\vec e_n
\\&=c_1\lambda_1^t\bigg[e_1+\sum\frac{c_2}{c_1}\bigg(\frac{\lambda_i}{\lambda_1}\bigg)^t\vec e_i)\bigg]
\end{align*}
$$
å½“$t\rightarrow +\infty$æ—¶ï¼Œ$\frac{c_2}{c_1}(\frac{\lambda_i}{\lambda_1})^t$ä¼šè¶‹å‘äº0ã€‚è¯¥æ–¹æ³•çš„æå‡ºè€…è®¤ä¸ºï¼Œåœ¨æœ‰æ•ˆæˆåˆ†$\vec e_i$çš„$\lambda_i$å¾€å¾€ä¼šæ¥è¿‘äº$\lambda_1$ï¼Œè€Œé«˜é¢‘çš„ä¸€äº›å™ªå£°æˆåˆ†$\lambda_j$ä¼šæ¥è¿‘äº0ã€‚åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ä½¿å¾—æœ‰æ•ˆæˆåˆ†$\vec e_i$å‰é¢çš„æƒé‡å’Œå™ªå£°æˆåˆ†å‰çš„æƒé‡çš„å·®è·ä¼šè¿…é€Ÿæ‰©å¤§ã€‚

ä½†æ˜¯è¿­ä»£çš„æ¬¡æ•°ä¸å®œè¿‡å¤šï¼Œå› ä¸ºæœ€åçš„ç»“æœä¼šè¶‹å‘äº$k\vec 1$ï¼Œå› ä¸º$W$çš„ä¸»ç‰¹å¾å‘é‡å°±æ˜¯$\vec 1$ã€‚å› æ­¤æˆ‘ä»¬éœ€è®¾ç½®ä¸€ä¸ªè¿­ä»£çš„é—¨é™å€¼ï¼Œä»¥æˆªæ–­è¿­ä»£è¿‡ç¨‹ã€‚å…·ä½“çš„ç®—æ³•å¦‚ä¸‹ã€‚

<img src="https://imagehost.vitaminz-image.top/gnn-note-11.png" style="zoom: 40%;" />

è¿™é‡Œä»¥è®ºæ–‡ä¸­å¼€å§‹æåˆ°çš„3åœ†åœˆæ•°æ®é›†ä¸ºä¾‹å­ï¼Œè¿›è¡Œç»“æœçš„å¤ç°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

<img src="https://imagehost.vitaminz-image.top/li-spectral-cluster-5.png" style="zoom:50%;" />

é€šè¿‡ä»¥ä¸Šçš„ç®—æ³•ï¼Œæˆ‘é€‰å–å‡ æ¬¡çš„è¿­ä»£ç»“æœ$\vec v^{(t)}$è¿›è¡Œå¯è§†åŒ–ï¼ŒåŒä¸€ä¸ªç±»åˆ«åœ¨åé¢çš„è¿­ä»£è¿‡ç¨‹ä¸­é€æ¸å±€éƒ¨æ”¶æ•›åˆ°ä¸€ä¸ªå€¼ã€‚

<img src="https://imagehost.vitaminz-image.top/li-spectral-cluster-7.png" style="zoom: 60%;" />

åœ¨å®éªŒä¸­å‘ç°ï¼Œå…¶ç»“æœå’Œè®¸å¤šå› ç´ æœ‰å…³ï¼Œå…¶ä¸­åŒ…æ‹¬é«˜æ–¯æ ¸è·ç¦»åº¦é‡ä¸­çš„$\sigma$ï¼Œåˆå§‹çš„å‘é‡$\vec v^{(0)}$ï¼ˆè®ºæ–‡ä¸­å–$\vec v^{(0)}= \frac{\sum_j A_{ij}}{\sum_i\sum_j A_{ij}}$ï¼‰ï¼Œç»“æŸæ—¶çš„$\hat\epsilon$è®¾ç½®ï¼Œç”šè‡³å‘ç°ä½¿ç”¨$W^T$å…·æœ‰æ›´å¥½çš„æ•ˆæœï¼Œè¿™æ˜¯å› ä¸º$W^T$çš„ä¸»ç‰¹å¾å€¼çš„ç‰¹å¾å‘é‡å°±å·²ç»å…·æœ‰åˆ†ç±»çš„æ•ˆæœï¼ˆå…¶æ„ä¹‰å°šå¾…ç ”ç©¶ï¼‰ï¼Œè€Œ$W$çš„ä¸»ç‰¹å¾å‘é‡æ˜¯$\vec 1$ï¼Œä½†è¿™ä»…ä»…é’ˆå¯¹äº3åœ†åœˆè¿™ä¸€æ•°æ®é›†è€Œè¨€ã€‚åœ¨[é—®é¢˜ä¸æ€»ç»“](#é—®é¢˜ä¸æ€»ç»“)ä¸­ï¼Œä¼šæåˆ°è¿™ä¸€ç‚¹ã€‚æ­¤å¤–è¿˜æœ‰è®¡ç®—æœºçš„è¿ç®—ç²¾åº¦ä¹Ÿä¼šå½±å“ç»“æœã€‚

è¯¥æ–¹æ³•çš„ä¸€ä¸ªé‡è¦ä¼˜ç‚¹æ˜¯ç®€å•é«˜æ•ˆï¼Œå…¶æ”¶æ•›é€Ÿåº¦å¿«ï¼Œåœ¨ç™¾ä¸‡çº§åˆ«çš„æ•°æ®ä¸­ä¹Ÿèƒ½åœ¨å‡ ç§’å†…æ”¶æ•›ã€‚ç¼ºé™·æ˜¯è¿‡åˆ†æ‹”é«˜äº†ç‰¹å¾å€¼å¤§çš„éƒ¨åˆ†ï¼Œåœ¨å¤šå°ºåº¦æ•°æ®ä¸­å­˜åœ¨ä¸€äº›ä½ç‰¹å¾å€¼ä½†ä»ç„¶é‡è¦çš„ä¿¡æ¯ã€‚

ä»¥ä¸‹æ˜¯ä¸»å‡½æ•°çš„ä»£ç ï¼Œå®Œæ•´ä»£ç è§ï¼šhttps://github.com/vitaminzl/SpectralCluster/blob/master/PI.py

```python
def main():
    data, labels = get3CircleData(radius=[0.1, 6, 17], nums=[10, 30, 80])
    draw3CircleData(x=data[:, 0], y=data[:, 1], labels=labels, title="Data Set")
    S_mtx = getSimilarMatrix(data, sigma=1.8)
    W = np.diag(1 / np.sum(S_mtx, axis=0)) @ S_mtx
    v_t = PowerIter(W, iter_nums=300, eps=1e-5, labels=labels)
    plt.show()
```



## TKNN

![](https://imagehost.vitaminz-image.top/li-spectral-cluster-10.png)

èšç±»é—®é¢˜è½¬åŒ–ä¸ºå›¾é—®é¢˜æ—¶ï¼Œéœ€è¦è§£å†³é‚»æ¥é—®é¢˜ã€‚å®šä¹‰ç»“ç‚¹ä¹‹é—´çš„è¿æ¥å¸¸å¸¸æœ‰2ç§æ–¹å¼[^4]ã€‚ç¬¬ä¸€ç§å¦‚ä¸Šå›¾å·¦ï¼Œæ¯ä¸ªæ•°æ®é€‰æ‹©è‡ªå·±æœ€è¿‘çš„Kä¸ªé‚»å±…ç›¸é‚»æ¥ï¼Œå¾—åˆ°çš„å›¾è¢«ç§°ä¸ºKé‚»æ¥å›¾ï¼ˆK Nearest Neighbor Graphï¼‰ï¼›ç¬¬äºŒç§å¦‚ä¸Šå›¾å³ï¼Œæ¯ä¸ªç»“ç‚¹é€‰æ‹©åŠå¾„$\epsilon$çš„é‚»å±…ç›¸é‚»æ¥ã€‚

![](https://imagehost.vitaminz-image.top/li-spectral-cluster-14.png)

å‡å¦‚æˆ‘ä»¬ä½¿ç”¨KNNçš„æ–¹æ³•ï¼ŒKå–4ã€‚å¦‚ä¸Šå›¾aæ‰€ç¤ºï¼Œçº¢è‰²ç»“ç‚¹çš„4ä¸ªæœ€è¿‘é‚»ç”¨çº¢çº¿è¿æ¥ï¼Œç»¿è‰²ç»“ç‚¹çš„4ä¸ªæœ€è¿‘é‚»ç”¨ç»¿çº¿è¿æ¥ã€‚æˆ‘ä»¬ä¼šå‘ç°ï¼Œè™½ç„¶çº¢è‰²çš„æœ€è¿‘é‚»åŒ…æ‹¬ç»¿è‰²ï¼Œä½†ç»¿è‰²ä¸åŒ…æ‹¬çº¢è‰²ï¼Œæˆ‘ä»¬ç§°çº¢è‰²å’Œç»¿è‰²ä¸æ˜¯**ç›¸äº’è¿‘é‚»**ã€‚ä½†å¦‚å›¾bæ‰€ç¤ºï¼Œåˆ™çº¢è‰²å’Œç»¿è‰²åˆ™ä¸ºç›¸äº’è¿‘é‚»ã€‚è‹¥2ä¸ªç»“ç‚¹æ˜¯ç›¸äº’è¿‘é‚»ï¼Œåˆ™ç§°è¿™2ä¸ªç»“ç‚¹**ç›¸äº’å¯è¾¾**ã€‚å¦‚å›¾cæ‰€ç¤ºï¼Œçº¢è‰²ä¸ç»¿è‰²æ˜¯ç›¸äº’è¿‘é‚»ï¼Œç»¿è‰²å’Œé»„è‰²ç›¸äº’è¿‘é‚»ï¼Œé‚£ä¹ˆçº¢è‰²å’Œç»¿è‰²ä¹Ÿ**ç›¸äº’å¯è¾¾**ã€‚

Transitive K Nearest Neighbor(TKNN) Graph æ˜¯æŒ‡å½“2ä¸ªç»“ç‚¹æ—¶ç›¸äº’å¯è¾¾çš„ï¼Œåˆ™äºŒè€…è¿æ¥ä¸€æ¡è¾¹ã€‚å› æ­¤å…¶é‚»æ¥çŸ©é˜µ$W$ä¸­ï¼Œè‹¥2ä¸ªç‚¹$i,j$ç›¸äº’å¯è¾¾ï¼Œ$W_{i,j}=W_{j,i}=1$ã€‚

æ„é€ çš„è¿‡ç¨‹å¯æè¿°å¦‚ä¸‹ï¼š

* step1: æ„é€ Ké‚»æ¥çŸ©é˜µ$A$ï¼Œå¯¹äºç»“ç‚¹$i$ç”±$k$ä¸ªé‚»å±…$j$ï¼Œåˆ™$A_{i, j}=1$
* step2: æ„é€ ç›¸äº’è¿‘é‚»çŸ©é˜µ$A'=A A^T$ï¼Œè‹¥ä¸ºç›¸äº’è¿‘é‚»ï¼Œåˆ™ä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚
* step3: å¯»æ‰¾$A'$çš„æ‰€æœ‰è¿é€šåˆ†é‡$S$
* step4: å¯¹äºè¿é€šåˆ†é‡$S_i$ä¸­çš„æ¯2ä¸ªå…ƒç´ $S_{i,j}, S_{i,k}$ï¼Œä»¤$W_{S_{i,j},S_{i,k}}=W_{S_{i,k},S_{i,j}}=1$ï¼Œå…¶ä½™ä¸º0ã€‚

ä»£ç å¦‚ä¸‹ï¼š

```python
def getTKNN_W(S_mtx, K):
    N = S_mtx.shape[0]
    KNN_A = np.zeros((N, N), dtype=np.int32)
    for i in range(N):
        idx = np.argsort(S_mtx[i, :])
        KNN_A[i, idx[(N-K):]] = 1
    MKNN_A = KNN_A * KNN_A.T
    G = nx.from_numpy_array(MKNN_A)
    compo_list = [c for c in nx.connected_components(G)]
    TKNN_W = np.zeros((N, N), dtype=np.int32)
    for c_i in compo_list:
        c = np.array(list(c_i), dtype=np.int32)
        idx_c = np.tile(c, (len(c), 1))
        TKNN_W[idx_c.T, idx_c] = 1 - np.identity(len(c))

    return TKNN_W
```



## ROSC

![](https://imagehost.vitaminz-image.top/li-spectral-cluster-9.png)

å¦‚ä¸Šå›¾æ‰€ç¤ºä¸ºROSCæ–¹æ³•çš„æµç¨‹å›¾ã€‚ROSCæ–¹æ³•[^1]ç»“åˆäº†ä»¥ä¸Š2ç§æ–¹æ³•ï¼Œä½†ç›¸æ¯”äºPIæ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œå®ƒå¹¶ä¸æ˜¯å°†PIå¾—åˆ°çš„è¾“å‡ºç›´æ¥ä½œä¸ºk-meansèšç±»çš„è¾“å…¥ï¼Œè€Œæ˜¯å¢åŠ äº†ä¸€ä¸ªæ±‚ä¿®æ­£ç›¸ä¼¼çŸ©é˜µçš„è¿‡ç¨‹ã€‚

é¦–å…ˆéšæœºè®¾ç½®ä¸åŒçš„$\vec v^{(0)}$è·å–$p$ä¸ªâ€œä¼ªç‰¹å¾å‘é‡â€ï¼Œæ‹¼æˆä¸€ä¸ª$p\times n$çš„çŸ©é˜µçŸ©é˜µ$X$ï¼Œå¹¶å¯¹$X$è¿›è¡Œæ ‡å‡†åŒ–ï¼Œå³ä½¿å¾—$XX^T=I$ã€‚

ROSCè®ºæ–‡ä¸­è®¤ä¸ºï¼Œç›¸ä¼¼åº¦çŸ©é˜µçš„æ„ä¹‰å¯ä»¥è¡¨ç¤ºä¸ºæŸä¸€ä¸ªå®ä½“èƒ½å¤Ÿè¢«å…¶ä»–å®ä½“æ‰€æè¿°çš„ç¨‹åº¦ã€‚å³ä»»ä½•ä¸€ä¸ªå®ä½“$x_{i}=\sum Z_{i,j}x_j$ï¼Œè¿™é‡Œ$Z_{i,j}$å³ä¸ºä¿®æ­£ç›¸ä¼¼åº¦çŸ©é˜µã€‚å› æ­¤å°±æœ‰ï¼š
$$
X=XZ+O
$$
å…¶ä¸­$O$è¡¨ç¤ºå™ªå£°çŸ©é˜µã€‚

å®šä¹‰ä¼˜åŒ–é—®é¢˜
$$
\min_{Z}||X-XZ||_F^2+\alpha_1||Z||_F+\alpha_2||W-Z||_F
$$
ä¼˜åŒ–é—®é¢˜çš„ç¬¬ä¸€é¡¹è¡¨ç¤ºæœ€å°åŒ–å™ªå£°ï¼Œç¬¬äºŒé¡¹åˆ™æ˜¯$Z$çš„Frobenius èŒƒæ•°[^12]ï¼‰ï¼Œä¸ºæ­£åˆ™åŒ–é¡¹ï¼Œç”¨äºå¹³è¡¡å…¶ä»–2é¡¹ï¼Œç¬¬ä¸‰é¡¹åˆ™æ˜¯å‡å°ä¸å‰æ–‡ä¸­TKNNçš„é‚»æ¥çŸ©é˜µ$W$çš„å·®è·ã€‚$\alpha_1,\alpha_2$æ˜¯å¹³è¡¡å‚æ•°ï¼Œéœ€è¦äººå·¥è®¾ç½®ã€‚

æ±‚è§£ä»¥ä¸Šä¼˜åŒ–é—®é¢˜ï¼Œå¯ä»¥å…ˆå¯¹$Z$æ±‚å¯¼ï¼ˆ[æ–‡ç« çš„åé¢](#Derivatives of Matrix)è¿˜ä¼šåšä¸€äº›è¡¥å……ï¼‰ï¼Œä½¿å¯¼æ•°ä¸º0å³å¯ã€‚å¯¹ä¸‰é¡¹é¡¹æ±‚å¯¼æœ‰
$$
\begin{align*}
\frac{\partial ||X-XZ||^2_F}{\partial Z}&=-2X^T(X-XZ)\\
\frac{\partial\alpha_1||Z||^2_F}{\partial Z}&=2\alpha_1Z\\
\frac{\partial\alpha_2||W-Z||^2_F}{\partial Z}&=-2\alpha_2(W-Z)
\end{align*}
$$
ä¸‰é¡¹ç›¸åŠ æœ‰
$$
-X^T(X-XZ)+\alpha_1Z-\alpha_2(W-Z)=0
$$
æ•´ç†å¯å¾—
$$
Z^*=(2X^TX+\alpha_1 I+\alpha_2 I)^{-1}(X^TX+\alpha_2W)
$$
ä½†è¿™æ ·æ±‚å‡ºæ¥çš„$Z^*$å¯èƒ½ä½¿ä¸å¯¹ç§°çš„ï¼Œä¸”å¯èƒ½å­˜åœ¨è´Ÿæ•°ã€‚æ‰€ä»¥è¿™é‡Œå†æ¬¡åšäº†ä¸€ä¸ªä¿®æ­£$\tilde Z=(|Z^*|+|Z^*|^T)/2$ã€‚

æ¥ä¸‹æ¥å°±å¯ä»¥æ‰§è¡Œä¸€èˆ¬çš„è°±èšç±»æ–¹æ³•äº†ã€‚å…·ä½“çš„ç®—æ³•æµç¨‹å¯ä»¥ç”¨å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

<img src="https://imagehost.vitaminz-image.top/li-spectral-cluster-12.png" style="zoom: 33%;" />

ç®—æ³•ç¬¬4è¡Œä¸­çš„whitenä¸ºç™½åŒ–å¤„ç†[^9]ï¼Œæ˜¯æ•°æ®é¢„å¤„ç†çš„ä¸€ç§å¸¸ç”¨æ–¹æ³•ã€‚å®ƒç±»ä¼¼äºPCAï¼Œä½†ä¸PCAä¸åŒçš„æ˜¯ï¼ŒPCAå¾€å¾€ç”¨æ¥é™ç»´ï¼Œè€Œç™½åŒ–åˆ™æ˜¯åˆ©ç”¨PCAçš„ç‰¹å¾å‘é‡ï¼Œå°†æ•°æ®è½¬æ¢åˆ°æ–°çš„ç‰¹å¾ç©ºé—´ï¼Œç„¶åå¯¹æ–°çš„åæ ‡è¿›è¡Œæ–¹å·®å½’ä¸€åŒ–ï¼Œç›®çš„æ˜¯å»é™¤è¾“å…¥æ•°æ®çš„å†—ä½™ä¿¡æ¯ã€‚

æ ¹æ®ä¸Šè¿°ç®—æ³•ï¼Œä»¥ä¸‹ä½¿ç”¨pythonå¯¹å…¶è¿›è¡Œå¤ç°ã€‚

```python
def ROSC(S, C_k, t_k, alpha1, alpha2):
    W_tknn = getTKNN_W(S, K=t_k)
    W = np.diag(np.sum(S, axis=0)) @ S
    X = prep.PIC_k(W, k=C_k)
    X = prep.whiten(X)
    X = prep.norm(X)
    Z = getROSC_Z(X.T, W_tknn, alpha1, alpha2)
    Z = (np.abs(Z) + np.abs(Z.T)) / 2
    C = postp.ncuts(Z, C_k)
    return C
```

ä¸»å‡½æ•°çš„ä»£ç å¦‚ä¸‹

```python
def main(data_name):
    path = "dataset/" + data_name + ".txt"
    data = np.loadtxt("dataset/Syn.txt", delimiter=',', dtype=np.float64)
    label = np.loadtxt("dataset/SynLabel.txt", dtype=np.int32)
    C_k = len(set(label))
    S = prep.getSimilarMatrix2(data=data)
    C = ROSC(S, C_k=C_k, t_k=t, alpha1=1, alpha2=0.01)
    prt, AMI, RI = postp.assess(label_true=label, label_pred=C)
    print(f"{data_name}\nPurity: {prt}\nAMI: {AMI}\nRI: {RI}\n")
```

å®Œæ•´ä»£ç è§https://github.com/vitaminzl/SpectralCluster/blob/master/ROSC.py

![](https://imagehost.vitaminz-image.top/li-spectral-cluster-20.png)

æˆ‘é¦–å…ˆä½¿ç”¨äº†äººå·¥åˆæˆçš„æ•°æ®é›†ï¼Œå¦‚ä¸Šå›¾å·¦æ‰€ç¤ºã€‚ä½¿ç”¨è®ºæ–‡ä¸­çš„å‚æ•°æ•ˆæœå¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œç„¶åè°ƒæ•´äº†ä¸€ä¸‹æ±‚è§£TKNNçŸ©é˜µçš„Kï¼ŒåŸæ–‡ä½¿ç”¨çš„æ˜¯4ï¼Œæˆ‘è°ƒæ•´ä¸º8ï¼Œç»“æœæ•ˆæœçŒ›å¢ï¼Œç”šè‡³ä¼˜äºè®ºæ–‡çš„ç»“æœï¼Œå¦‚ä¸Šå›¾å³æ‰€ç¤ºï¼Œåªæœ‰æä¸ªåˆ«ç‚¹åˆ†é”™ã€‚ä¸è¿‡æ ¹æ®æ•°æ®é›†è°ƒå‚è¿˜æ˜¯ä¸ç§‘å­¦çš„å“ˆå“ˆå“ˆğŸ˜‚ã€‚å…¶ä¸­Purity=0.9861ï¼ŒAMI=0.9307ï¼ŒRI=0.9784ã€‚

ç„¶åæˆ‘å¯¹TKNNçš„Kå‚æ•°ä»1åˆ°12å¼€å§‹è°ƒæ•´ï¼Œ3ä¸ªæŒ‡æ ‡çš„å˜åŒ–æ›²çº¿å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æ„Ÿè§‰å˜åŒ–è¿˜æ˜¯è›®æ˜æ˜¾çš„ã€‚

<img src="https://imagehost.vitaminz-image.top/li-spectral-cluster-17.png" style="zoom: 67%;" />

ä»¥ä¸‹æ˜¯5ä¸ªæ•°æ®é›†çš„å®éªŒç»“æœï¼Œå‚æ•°é™¤äº†TKNNæ˜¯çš„Kæ˜¯8ä»¥å¤–ï¼Œå…¶ä»–éƒ½å’ŒåŸè®ºæ–‡ç›¸åŒï¼Œå³$\alpha_1=1,\alpha_2=0.01$ã€‚å¤§éƒ¨åˆ†çš„æ•°æ®é›†éƒ½æ²¡æœ‰è®ºæ–‡çš„ç»“æœå¥½ï¼ˆæ¯”è®ºæ–‡ç»“æœå¥½çš„åŠ äº†ç²—ï¼‰ï¼Œä½†ä¹Ÿç›¸å·®ä¸å¤šã€‚é™¤äº†MNist0127è¿™ä¸ªæ•°æ®é›†æ˜¯ä¾‹å¤–ï¼Œå…¶ç»“æœå¼‚å¸¸åœ°å·®åŠ²ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› ã€‚

| æ•°æ®é›†    | Purity     | AMI    | RI         |
| --------- | ---------- | ------ | ---------- |
| COIL20    | 0.8486     | 0.9339 | 0.9683     |
| Glass     | **0.6074** | 0.2949 | **0.7233** |
| MNIST0127 | 0.2767     | 0.0156 | 0.3981     |
| Isolet    | 0.7067     | 0.6151 | 0.8459     |
| Yale      | 0.5636     | 0.3215 | 0.7704     |



## Trace Lasso

Trace Lasso[^13]æ˜¯ä¸€ç§ä»‹äºL1å’ŒL2æ­£åˆ™çš„æ­£åˆ™åŒ–é¡¹ã€‚å…¶å½¢å¼ä¸º
$$
\Omega(W)=||XDiag(W)||_*
$$
å…¶ä¸­$X$ä¸ºå·²å½’ä¸€åŒ–çš„ç‰¹å¾çŸ©é˜µï¼Œå³å¯¹äºç‰¹å¾$\vec x_i$æœ‰$\vec x_i \vec x_i^T=1$ã€‚$W$ä¸ºå¾…æ±‚å‚æ•°ã€‚$||Â·||_*$ä¸ºæ ¸èŒƒæ•°[^14]ï¼ˆæˆ–è¿¹èŒƒæ•°ï¼‰,$||Z||_*=tr(\sqrt{Z^TZ})$ï¼Œè¡¨ç¤ºæ‰€æœ‰å¥‡å¼‚å€¼ä¹‹å’Œã€‚

Trace Lassoå…·æœ‰å¦‚ä¸‹æ€§è´¨ï¼š

* å½“$X^TX=I$æ—¶ï¼Œå³ç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§ä¸º0ï¼Œæˆ–è€…æ­£äº¤ï¼Œé‚£ä¹ˆ
  $$
  \Omega(W)=||W||_1
  $$
  å³é€€åŒ–ä¸º1èŒƒå¼ã€‚

* å½“$X^TX=\vec 1^T\vec 1$æ—¶ï¼Œå³æ‰€æœ‰ç‰¹å¾éƒ½å®Œå…¨ç›¸å…³ï¼Œé‚£ä¹ˆ
  $$
  \Omega(W)=||W||_2
  $$
  å³é€€åŒ–ä¸º2èŒƒå¼

* å…¶ä»–æƒ…å†µä¸‹ï¼Œåœ¨1èŒƒå¼å’Œ2èŒƒå¼ä¹‹é—´ã€‚

Trace Lassoçš„ä¼˜ç‚¹å°±æ˜¯å®ƒå¯ä»¥æ ¹æ®æ•°æ®çš„ç‰¹å¾ï¼Œæ¥è¿‘åˆé€‚çš„èŒƒå¼ï¼Œè¿™ç›¸æ¯”å¼¹æ€§ç½‘ç»œæ›´å¥½ã€‚



## CAST

ROSCæ–¹æ³•è™½ç„¶å¯ä»¥åŠ å¼ºç±»å†…æ•°æ®çš„è”ç³»ï¼Œä½†æ²¡æœ‰ä½¿å¾—ç±»é—´çš„é—´è·å¢å¤§ã€‚

è€ŒCASTç›¸æ¯”äºROSCçš„åŒºåˆ«å°±åœ¨äºä¿®æ”¹äº†ä¼˜åŒ–å‡½æ•°[^2]ï¼Œæˆä¸ºå¦‚ä¸‹å½¢å¼ï¼š
$$
\min_{Z} \frac{1}{2} ||\vec x-X\vec z||_2+\alpha_1||XDiag(\vec z)||_*+\frac{\alpha_2}{2}||W-\vec z||_2
$$
å…¶ä¸­$\vec x$æ˜¯$X$çš„å…¶ä¸­ä¸€ä¸ªç‰¹å¾å‘é‡ï¼Œ$z$æ˜¯ä¿®æ­£ç›¸ä¼¼åº¦çŸ©é˜µ$Z$ä¸­çš„ä¸€ä¸ªå‘é‡ã€‚äºROSCçš„ä¸»è¦åŒºåˆ«åœ¨äºèŒƒæ•°çš„é€‰æ‹©ï¼Œé€šè¿‡trace lassoå¯ä»¥ä½¿å¾—å…¶å…·æœ‰ç±»å†…èšåˆä¹Ÿæœ‰ç±»å¤–ç¨€ç–çš„ç‰¹æ€§ã€‚

è¯¥ä¼˜åŒ–é—®é¢˜çš„æ±‚è§£å·²ç»è¶…å‡ºäº†æˆ‘çš„èƒ½åŠ›èŒƒå›´ï¼Œåœ¨æ­¤ç›´æ¥è´´å‡ºè®ºæ–‡ä¸­çš„ç®—æ³•æµç¨‹

<img src="https://imagehost.vitaminz-image.top/li-spectral-cluster-15.png" style="zoom: 50%;" />

æ•´ä¸ªCASTç®—æ³•çš„æµç¨‹å¦‚ä¸‹ï¼š

<img src="https://imagehost.vitaminz-image.top/li-spectral-cluster-16.png" style="zoom:50%;" />

å¯¹æ¯”ROSCï¼Œä»–ä»¬çš„åŒºåˆ«å°±åœ¨äºæ±‚è§£$Z^*$çš„æ–¹æ³•ä¸åŒï¼Œå…¶ä½™éƒ½æ˜¯ä¸€æ ·çš„ã€‚

ç”±äºInexcat ALMçš„ç®—æ³•è¶…å‡ºäº†æˆ‘çš„çŸ¥è¯†èŒƒç•´ï¼Œå¹¶ä¸”æœ€è¿‘äº‹æƒ…è¾ƒå¤šï¼ŒCASTç®—æ³•çš„ä»£ç å¹¶æ²¡æœ‰å¤ç°ã€‚è‹¥åé¢æœ‰æ—¶é—´å†å¡«è¡¥ç©ºç¼ºã€‚



## Group Effect

Group Effectåœ¨ROSCå’ŒCASTè®ºæ–‡ä¸­éƒ½æåŠäº†ï¼Œä»¥åŠä¸€ç¯‡å…³äºGNNçš„è®ºæ–‡[^7]ä¸­ä¹ŸæåŠäº†ï¼Œå¯ä»¥è¯´ç²¾é«“æ‰€åœ¨äº†ã€‚

é¦–å…ˆå®šä¹‰ä¸€äº›ç¬¦å·ï¼šè‹¥æœ‰ä¸€ç³»åˆ—çš„å®ä½“$X=\{x_1,x_2,...,x_n\}$ï¼Œè®¾$w_q$ä¸º$W$çš„ç¬¬$q$åˆ—ï¼Œè®¾$x_i\rightarrow x_j$è¡¨ç¤ºï¼Œ$x_i^Tx_j\rightarrow 1$ä¸”$||w_i-w_j||_2\rightarrow 0$ã€‚

å¦‚æœçŸ©é˜µ$Z$æ»¡è¶³å½“$x_i\rightarrow x_j$æ—¶ï¼Œæœ‰$|Z_{ip}-Z_{jp}|\rightarrow 0$ï¼Œåˆ™ç§°$Z$å…·æœ‰Group Effectã€‚

ç¿»è¯‘æˆäººè¯å°±æ˜¯å½“2ä¸ªå®ä½“è¶³å¤Ÿæ¥è¿‘ï¼Œ$Z$çŸ©é˜µä¸­å®ä½“å¯¹åº”çš„å…ƒç´ ä¹Ÿè¶³å¤Ÿçš„æ¥è¿‘ã€‚è¿™è¯´æ˜äº†$Z$çŸ©é˜µç¡®å®èƒ½å¤Ÿåæ˜ å®ä½“ä¹‹é—´çš„è”ç³»ç´§å¯†ç¨‹åº¦ã€‚2ä¸ªå®ä½“è¶³å¤Ÿæ¥è¿‘ï¼Œå®ƒå¯ä»¥æŒ‡å®ä½“çš„ç‰¹å¾è¶³å¤Ÿæ¥è¿‘ï¼Œä¹Ÿå¯ä»¥æŒ‡å®ä½“é™„è¿‘çš„ç»“æ„æ¥è¿‘ã€‚äº‹å®ä¸Šåœ¨å¦ä¸€ç¯‡å…³äºGNNçš„è®ºæ–‡[^7]é‡Œè¿˜åŒ…æ‹¬äº†å®ä½“é™„è¿‘çš„ç»“æ„ä¿¡æ¯ã€‚

å¯ä»¥è¯æ˜çš„æ˜¯ï¼ŒROSCå’ŒCASTä¸­çš„ç¨€ç–çŸ©é˜µéƒ½æœ‰Group Effectï¼Œè¯æ˜çš„è¿‡ç¨‹è¿‡äºå¤æ‚ï¼Œä¹Ÿè¶…å‡ºäº†æˆ‘çš„èƒ½åŠ›èŒƒå›´äº†ğŸ˜‚ã€‚



## è¡¥å……

### Dominant Eigenvalue

è‹¥ä¸€ä¸ªæ–¹é˜µ$A$å­˜åœ¨ä¸€ç³»åˆ—ç‰¹å¾å€¼$\lambda_1,\lambda_2,...,\lambda_n$ï¼Œä¸”æ»¡è¶³$|\lambda_1|>|\lambda_2|\ge...\ge|\lambda_n|$ï¼Œåˆ™ç§°$\lambda_1$ä¸ºè¯¥æ–¹é˜µçš„ä¸»ç‰¹å¾å€¼[^10]ã€‚å‰æ–‡ä¸­çš„å¹‚è¿­ä»£æ³•åŸæœ¬å°±æ˜¯ç”¨æ¥æ±‚ä¸»ç‰¹å¾å€¼çš„ã€‚
$$
\begin{align*}
 A^kq^{(0)} &= A^{k-1}q^{(1)} = ... =Aq^{(kâˆ’1)} 
\\&=a_1A^k\vec  e_1 + a_2A^k\vec e_2,..., +a_nA^k\vec e_n
\\&=a_1\lambda_1^k  e_1 + a_2\lambda_2^k\vec e_2,..., +a_n\lambda_n^k\vec e_n
\\&=a_1\lambda_1^k\bigg[e_1+\sum_{i=2}^{n}\frac{a_i}{a_1}\bigg(\frac{\lambda_i}{\lambda_1}\bigg)^k\vec e_i)\bigg]
\end{align*}
$$
ç»è¿‡ä¸€ç³»åˆ—è¿­ä»£ååˆå¦‚ä¸Šå¼å­ã€‚æ˜¾ç„¶ï¼Œå½“$k\rightarrow\infty$æ—¶ï¼Œ$q^{(k)}=Aq^{(kâˆ’1)}=A^kq^{(0)}\rightarrow a_1\lambda^kx_1$ã€‚å¹¶ä¸”$[q^{k}]^TAq^{(k)}\approx [q^{(k)}]^T\lambda q^{(k)}=\lambda\|q^{(k)}\|_2=\lambda$ï¼Œå½“$\|q^{(k)}\|_2=1$ã€‚æ‰€ä»¥æ¯æ¬¡è¿­ä»£éœ€è¦å¯¹$q$è¿›è¡Œä¸€æ¬¡æ ‡å‡†åŒ–ã€‚è¿™æ ·é€šè¿‡ç»è¿‡å¼å­å°±å¯æ±‚å‡ºä¸»ç‰¹å¾å€¼äº†ã€‚



### Derivatives of Matrix 

çŸ©é˜µæ±‚å¯¼æ˜¯çŸ©é˜µè®ºä¸­çš„ç›¸å…³çŸ¥è¯†[^11]ï¼Œè¿™é‡Œä»…å¯¹å‰æ–‡ç”¨åˆ°çš„FrobeniusèŒƒå¼çŸ©é˜µçš„æ±‚å¯¼è¿‡ç¨‹è¿›è¡Œä»‹ç»ã€‚

FrobeniusèŒƒå¼å¯ä»¥è¡¨ç¤ºæˆå¦‚ä¸‹çš„è¿¹å½¢å¼
$$
||X||_F=\sqrt{tr(X^TX)}
$$
é¦–å…ˆå¼•å…¥2ä¸ªæ±‚å¯¼æ³•åˆ™

* æ³•åˆ™1ï¼šè‹¥$A,X$ä¸º$m\times n$çš„çŸ©é˜µï¼Œæœ‰
  $$
  \frac{\partial tr(A^TX)}{\partial X}=\frac{\partial tr(X^TA)}{\partial X}=A
  $$

* æ³•åˆ™2ï¼šè‹¥$A$ä¸º$m\times m$çš„çŸ©é˜µï¼Œ$X$ä¸º$m\times n$çš„çŸ©é˜µï¼Œæœ‰

$$
\frac{\partial tr(X^TAX)}{\partial X}=AX+A^TX
$$

å› æ­¤è‹¥æ±‚ä»¥ä¸‹å¯¼æ•°
$$
\frac{\partial ||A-BX||^2_F}{\partial X}
$$
åˆ©ç”¨ä»¥ä¸Šæ³•åˆ™æœ‰ï¼š
$$
\begin{align*}
\frac{\partial||A-BX||^2_F}{\partial X}&=\frac{\partial tr[(A-BX)^T(A-BX)]}{\partial X}\\
&=\frac{\partial tr[(A^T-X^TB^T)(A-BX)]}{\partial X}\\
&=\frac{\partial[tr(A^TA)-2tr(A^TBX)+tr(X^TB^TBX)]}{\partial X}\\
&=0-2A^TB+B^TBX+B^TBX\\
&=-2B^T(A+BX)
\end{align*}
$$



## é—®é¢˜ä¸æ€»ç»“

åœ¨è¿™æ¬¡æ·±å…¥è§£è¯»è®ºæ–‡çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰å¾ˆå¤šæ”¶è·ï¼Œå­¦åˆ°äº†å¾ˆå¤šï¼Œä½†ä¹Ÿå‘è§‰ä¸æ˜ç™½çš„ä¸œè¥¿ä¹Ÿå¾ˆå¤šã€‚å®éªŒä¸­ä¹Ÿé‡åˆ°å„ç§é—®é¢˜ï¼Œæ¯”å¦‚åœ¨PIæ–¹æ³•çš„å®éªŒä¸­ï¼Œå‘ç°å¯¹$W^T=D^{-1}S$çš„æœ€å°ç‰¹å¾å‘é‡åœ¨3åœ†åœˆæ•°æ®é›†ä¸­ï¼Œå…·æœ‰æ˜æ˜¾çš„åˆ†å±‚ï¼Œå…¶åˆ†å±‚ç‰¹å¾å’Œç±»åˆ«åŸºæœ¬ä¸€è‡´ï¼Œè¿™æ˜¯ä¸€æ¬¡ä»£ç å†™é”™æ—¶å‘ç°çš„ã€‚ä»¥åŠè®ºæ–‡ä¸­å‡ºç°äº†éå¸¸å¤šä¼˜åŒ–é—®é¢˜æ±‚è§£ï¼Œä¹Ÿè§¦åŠåˆ°äº†å¾ˆå¤šçŸ¥è¯†ç›²åŒºã€‚ä½†åŒæ—¶ä¹Ÿæ¿€å‘äº†æˆ‘çš„æ±‚çŸ¥æ¬²æœ›ï¼Œéœ€è¦å­¦çš„ä¸œè¥¿è¿˜æœ‰å¾ˆå¤šã€‚



## å‚è€ƒèµ„æ–™

[^1]: [Li X, Kao B, Luo S, et al. Rosc: Robust spectral clustering on multi-scale data[C]//Proceedings of the 2018 World Wide Web Conference. 2018: 157-166.](https://dl.acm.org/doi/abs/10.1145/3178876.3185993)
[^2]: [Li X, Kao B, Shan C, et al. CAST: a correlation-based adaptive spectral clustering algorithm on multi-scale data[C]//Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery & Data Mining. 2020: 439-449.](https://dl.acm.org/doi/abs/10.1145/3394486.3403086)
[^3]: [Zelnik-Manor L, Perona P. Self-tuning spectral clustering[J]. Advances in neural information processing systems, 2004, 17.](https://proceedings.neurips.cc/paper/2004/hash/40173ea48d9567f1f393b20c855bb40b-Abstract.html)
[^4]: [https://csustan.csustan.edu/~tom/Clustering/GraphLaplacian-tutorial.pdf](https://csustan.csustan.edu/~tom/Clustering/GraphLaplacian-tutorial.pdf)
[^5]:[Lin F, Cohen W W. Power iteration clustering[C]//ICML. 2010.](https://openreview.net/forum?id=SyWcksbu-H)
[^6]: [Ng A, Jordan M, Weiss Y. On spectral clustering: Analysis and an algorithm[J]. Advances in neural information processing systems, 2001, 14.](https://proceedings.neurips.cc/paper/2001/hash/801272ee79cfde7fa5960571fee36b9b-Abstract.html)
[^7]: [[Li X, Zhu R, Cheng Y, et al. Finding Global Homophily in Graph Neural Networks When Meeting Heterophily[J]. arXiv preprint arXiv:2205.07308, 2022](https://arxiv.org/abs/2205.07308)
[^8]: [Shi J, Malik J. Normalized cuts and image segmentation[J]. IEEE Transactions on pattern analysis and machine intelligence, 2000, 22(8): 888-905.](https://ieeexplore.ieee.org/abstract/document/868688)
[^9]: [https://en.wikipedia.org/wiki/Whitening_transformation](https://en.wikipedia.org/wiki/Whitening_transformation)
[^10]: [https://www.cs.huji.ac.il/w~csip/tirgul2.pdf](https://www.cs.huji.ac.il/w~csip/tirgul2.pdf)
[^11]: [Petersen K B, Pedersen M S. The matrix cookbook[J]. Technical University of Denmark, 2008, 7(15): 510.](https://ece.uwaterloo.ca/~ece602/MISC/matrixcookbook.pdf)

[^12]: [https://mathworld.wolfram.com/FrobeniusNorm.html](https://mathworld.wolfram.com/FrobeniusNorm.html)

[^13]: [Grave E, Obozinski G R, Bach F. Trace lasso: a trace norm regularization for correlated designs[J]. Advances in Neural Information Processing Systems, 2011, 24.](https://proceedings.neurips.cc/paper/2011/hash/33ceb07bf4eeb3da587e268d663aba1a-Abstract.html)
[^14]: [https://en.wikipedia.org/wiki/Matrix_norm](https://en.wikipedia.org/wiki/Matrix_norm)
